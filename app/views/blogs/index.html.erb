<br>
<h1>All Posts</h1>
<p id="notice"><%= notice %>

<div id = "first_line">
  <div class = "new">
    <%= button_to 'Make new Post', new_blog_path, class:"new_blog", method: :get %>
  </div><br>

  <div class ="search">
    <%= form_with(url: search_blogs_path, class: "search_container", method: :get, local: true) do %>      
      <%= text_field_tag :search_detail %>  
      <%= submit_tag "Search", class: "search-btn" %>
    <% end %> 
  </div>
</div>

<div class="container">
  <div class="row">

    <div class="col-xs-12 col-sm-4 col-md-3" id="sticky-sidebar">
      <div class="sticky-top">
        <div class="card border-secondary mb-3" style="max-width: 18rem;">
          <div class = "col3">
            <div class="card-header">Header</div>
              <div class="card-body text-secondary">
                <h5 class="card-title">
                  Title
                </h5>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                      List
                    </li>
                    <li class="list-group-item">Dapibus ac facilisis in</li>
                    <li class="list-group-item">Vestibulum at eros</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>

    <div class="col-xs-6 col-sm-4 col-md-6">
      <% if @blogs.present? %>
        <% @blogs.each do |blog| %>
          <div class = "table-responsive">
            <table >
              <tr class="category">
                <th colspan="5" >
                  <% blog.categories.each do |category| %>
                    <%= category.name %>
                  <% end %>
                </th>
              </tr>

              <tr>
                <td>
                  <%= image_tag (blog.user.avatar.url), class: "avatar-index rounded-circle mx-auto"  if blog.user.avatar && blog.user.avatar.url %>
                </td>
                <td>
                  <%= blog.user.name %>
                </td>
                <td>
                  <%= blog.created_at.to_s(:datetime) %>
                </td>            
              </tr>

              <tr>
                <th colspan="5" class="th_title">
                    <%= blog.title %>
                <th>
              </tr>

              <tr>
                <th colspan="5" class="th_detail">
                <textarea rows="5" cols="35"><%= blog.detail %></textarea>
                <th>
              </tr>

              <tr>
                <td colspan="5" class="spk">
                  <button class="speak-btn" data-blog="<%= blog.detail %>">
                    <span class="material-icons">play_circle</span>
                  </button>
                  <button class="pause-btn">
                    <span class="material-icons">pause</span>
                  </button>
                  <button class="resume-btn">
                    <span class="material-icons">play_circle_outline</span>
                  </button>
                  <button class="stop-btn">
                    <span class="material-icons">stop_circle</span>
                  </button>
                </td>
              </tr>
              
              <tr>
                <th colspan="5" class="th">
                    <%= image_tag(blog.image.url) if blog.image && blog.image.url %>
                </th>
              <tr>

              <tr class="option">            
                <td colspan="5" >
                  <% if blog.favorites.present? %> 
                    <div class = "link_count">
                      <%= blog.favorites.size %> 
                    </div>                  
                    <i class="fa fa-heart" style="font-size:24px;color:hotpink"></i>                    
                    <%= link_to 'Dislike', blog_favorite_path(id: blog.id, blog_id: blog.id), class:'link_icon', method: :delete %>
                  <% else %>
                    <div class = "link_count">
                      <%= blog.favorites.size %> 
                    </div>
                    <i class="fa fa-heart" style="font-size:24px;color:hotpink"></i>                     
                    <%= link_to 'Like', favorites_path(blog_id: blog.id), class:'link_icon', method: :post %>
                  <% end %> 
                    <div class = "link_count">
                      <%= blog.comments.size %> 
                    </div>
                    <%= link_to 'Comment', blog, class:'link_icon' %>
                  <% if blog.user_id == current_user.id %>
                    <%= link_to 'Edit', edit_blog_path(blog), class:"link_blog" %>
                    <%= link_to 'Delete', blog, class:'link_blog', method: :delete, data: { confirm: 'Are you sure?' } %>                    
                  <% else %>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </table>          
        </div>
      </div>


    <div class="col-xs-12 col-sm-4 col-md-3" id="sticky-sidebar">
      <div class="sticky-top">
        <div class="card border-secondary mb-3" style="max-width: 18rem;">
          <div class = "col3">
            <div class="card-header">Header</div>
              <div class="card-body text-secondary">
                <h5 class="card-title">Info card title</h5>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">Cras justo odio</li>
                    <li class="list-group-item">Dapibus ac facilisis in</li>
                    <li class="list-group-item">Vestibulum at eros</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        
      </div>
    </div>

  <div class="pagination">
    <% if @blogs.present? %>
      <%= paginate @blogs %>    
    <% end %>
  </div>

  <% else %>
    <%= "Your search didn't match any results" %>        
  <% end %>    
  

