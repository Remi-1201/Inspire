<h1>My page</h1>

<p><%= link_to "Update my profile", edit_user_registration_path %> &nbsp;
<%= link_to "My favorites", favorites_path %></p> 


<% @blogs.each do |blog| %>
    <% if blog.user_id == @user.id %>
      <% if blog.present? %>
        <div class = "table-responsive">
          <table >
            <tr class="category">
              <th colspan="5" >
                <% blog.categories.each do |category| %>
                  <%= category.name %>
                <% end %>
              </th>
            </tr>

            <tr>
              <td>
                <%= image_tag (blog.user.avatar.url), class: "avatar-index rounded-circle mx-auto"  if blog.user.avatar && blog.user.avatar.url %>
              </td>
              <td>
                <%= blog.user.name %>
              </td>
              <td>
                <%= blog.created_at.to_s(:datetime) %>
              </td>
              <td>
                <%= link_to 'Show', blog %>
              </td>            
            </tr>

            <tr>
              <th colspan="5" class="th_title">
                  <%= blog.title %>
              <th>
            </tr>

            <tr>
              <th colspan="5" class="th_detail">              
                <%= blog.detail %>              
              <th>
            </tr>

            <tr>
              <td><button class="speak-btn" data-blog="<%= blog.detail %>">speak</button></td>                 
              <td><button class="stop-btn">stop</button></td>
              <td></td>
            </tr>

            <tr>
              <td>
                <div class="record">
                  <div id="Control">
                    <td>
                      <button id="MicOn">Get the microphone</button>
                    </td>
                    <td>
                      <button id="RecStart">Record</button>
                    </td>
                    <td>
                      <button id="RecStop" disabled>Stop</button>
                    </td>
                    <div id="RecMime">
                  </div>
                </div>
              </td>            
            </tr>

            <tr>
              <th colspan="5" class="th">
                  <%= image_tag(blog.image.url) if blog.image && blog.image.url %>
              </th>
            <tr>

            <tr class="option">            
              <td>
                <% if @favorite.present? %>
                  <%= link_to 'Dislike', favorite_path(id: favorite.id), method: :delete %>
                <% else %>
                  <%= link_to 'Like', favorites_path(blog_id: blog.id), method: :post %>
                <% end %>
              </td>
              <td>
                <%= link_to 'Edit', edit_blog_path(blog) %>
              </td>
              <td>
                <%= link_to 'Destroy', blog, method: :delete, data: { confirm: 'Are you sure?' } %>
              </td>
            </tr>
          <% end %>
        <% end %>
      <% end %>
    </table>
  </div><br>

  <% if @blogs.present? %>
    <div class="page">
      <%= paginate @blogs %>
    </div>
  <% end %>